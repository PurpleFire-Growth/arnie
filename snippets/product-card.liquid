{%- comment -%}
----------------------------------------------------------------------------------------------------------------------
PRODUCT CARD COMPONENT
----------------------------------------------------------------------------------------------------------------------

This component is used in collection and featured collection to render a single product as a card.

--------------------------------------------------------------------------------------------------
Supported variables
--------------------------------------------------------------------------------------------------
* product: the product to render
* show_rating: show or not the rating. If nothing is set, the theme uses the default product card setting
* show_vendor: show or not the vendor. If nothing is set, the theme uses the default product card setting
* show_quick_buy: show or not the quick buy. If nothing is set, the theme uses the default product card setting
* show_secondary_image: show or not the secondary image. If nothing is set, the theme uses the default product card setting
* show_swatches: allow to force hiding swatches. If nothing is set, it will default to the default card strategy
* stacked: indicate if the product is in stack mode
* position: the position of the card in the list. If specified, the theme will eagerly load the first 3 cards images
* reveal: if set to true the item will be revealed in a stacked mode
* background: the background to use for the product card (if none is passed then the one from the global setting is used)
* text_color: the text color to use for the product card (if none is passed then the one from the global setting is used)
* text_alignment: can be "center". If nothing is set, the theme uses the default product card setting
{%- endcomment -%}

{%- assign show_rating = show_rating | default: settings.show_product_rating, allow_false: true -%}
{%- assign show_vendor = show_vendor | default: settings.show_vendor, allow_false: true -%}
{%- assign show_quick_buy = show_quick_buy | default: settings.show_quick_buy, allow_false: true -%}
{%- assign show_secondary_image = show_secondary_image | default: settings.show_secondary_image, allow_false: true -%}
{%- assign text_alignment = text_alignment | default: settings.product_info_alignment -%}

<product-card handle="{{ product.handle | escape }}" {% if reveal and settings.stagger_products_apparition %}reveal-js{% endif %} {% render 'surface', class: card_class, background: card_background, text_color: card_text_color %}>

  {%- comment -%}
  --------------------------------------------------------------------------------------------------------------------
  PRODUCT IMAGE - Circular with green background
  --------------------------------------------------------------------------------------------------------------------
  {%- endcomment -%}
  <div class="product-card__image-wrapper" style="display: flex; justify-content: center;">
    <div class="product-card__image-circle" style="background-color: #009b67; border-radius: 50%; width: 150px; height: 150px; display: flex; align-items: center; justify-content: center;">
      <a href="{{ product.url }}" data-instant style="display: block;">
        {{ product.featured_media | image_url: width: 120 | image_tag: class: 'product-card__image-inner', style: 'object-fit: contain; width: 100px; height: 100px;' }}
      </a>
    </div>
  </div>

  {%- comment -%}
  --------------------------------------------------------------------------------------------------------------------
  BADGE - Positioned below the image
  --------------------------------------------------------------------------------------------------------------------
  {%- endcomment -%}
  {% comment %} {%- if show_badges and product.media.size > 0 -%}
    <div class="product-card__badge" style="background-color: #009b67; color: white; text-align: center; padding: 4px 8px; font-size: 0.9em; margin-top: 8px;">
      {%- render 'product-badges', product: product, context: 'card', class: 'product-card__badge-list' -%}
    </div>
  {%- endif -%} {% endcomment %}

  {%- comment -%}
  --------------------------------------------------------------------------------------------------------------------
  PRODUCT INFO - Name, Vendor, Ratings, and Price
  --------------------------------------------------------------------------------------------------------------------
  {%- endcomment -%}
  <div class="product-card__info" style="text-align: center; margin-top: 12px;">
    {%- if show_vendor and product.vendor != blank -%}
      <div class="product-card__vendor" style="font-size: 0.9em; color: #666;">{{ product.vendor | escape }}</div>
    {%- endif -%}

    <a href="{{ product.url }}" data-instant class="product-card__name h5" style="display: block; font-weight: bold; margin-top: 8px; color: #333;">{{ product.title | escape }}</a>

    {%- comment -%}
    PRICE DISPLAY - Current Price, Original Price (strikethrough), and Discount Tag
    {%- endcomment -%}
    <div class="product-card__price" style="margin-top: 8px;">
      {%- assign compare_at_price = product.compare_at_price -%}
      {%- if compare_at_price > product.price -%}
        <span class="product-card__original-price" style="text-decoration: line-through; color: #999; margin-right: 8px;">
          {{ compare_at_price | money }}
        </span>
        <span class="product-card__discount-price" style="font-weight: bold; color: #333;">
          {{ product.price | money }}
        </span>
        <span class="product-card__discount-tag" style="background-color: #D3B494; color: white; padding: 2px 6px; border-radius: 4px; margin-left: 8px; font-size: 0.8em;">
          {{ 'Save' }} {{ compare_at_price | minus: product.price | times: 100.0 | divided_by: compare_at_price | round }}%
        </span>
      {%- else -%}
        <span class="product-card__current-price" style="font-weight: bold; color: #333;">
          {{ product.price | money }}
        </span>
      {%- endif -%}
    </div>

    {%- comment -%}
    SHORT DESCRIPTION - Customizable
    {%- endcomment -%}
    <div class="product-card__description" style="margin-top: 8px; font-size: 0.9em; color: #666;">
      {{ product.description | strip_html | truncate: 80 }}
    </div>

    {%- comment -%}
    BUY NOW BUTTON - Rounded Green Button
    {%- endcomment -%}
    {%- if show_quick_buy and product.available -%}
      <div class="product-card__buy-now" style="margin-top: 16px;">
        <button type="button" class="buy-now-button" style="background-color: #009b67; color: white; padding: 10px 20px; border-radius: 20px; font-size: 1em; cursor: pointer;">
          {{ 'Buy Now' }}
        </button>
      </div>
    {%- endif -%}
  </div>

</product-card>
